var APIPATH,UserAuth,auth,db,epilogue,setup,sql;epilogue=require("epilogue"),db=require("./models"),sql=db.sequelize,UserAuth=require("./userauth"),auth=UserAuth.auth,APIPATH="/api/dev",setup=function(e){var s,u,o,r,d,n,t,i;return epilogue.initialize({app:e,sequelize:sql}),e.get(APIPATH+"/current-user",function(e,s,u){var o;return o=null,(null!=e?e.user:void 0)&&(o=e.user),s.json(o)}),e.put(APIPATH+"/current-user",auth,function(e,s,u){var o,r;return r=e.user,o=sql.models.user,console.log("req.body is",e.body),"config"in e.body?r.update({config:e.body.config,where:{id:r.id}}).then(s.json({result:"success"})):"password"in e.body?r.update({password:e.body.password,where:{id:r.id}}).then(s.json({result:"success"})):s.sendStatus(403)}),s=APIPATH+"/sunny/clients",u=epilogue.resource({model:sql.models.client,endpoints:[s,s+"/:id"]}),t=APIPATH+"/sunny/yards",i=epilogue.resource({model:sql.models.yard,endpoints:[t,t+"/:id"]}),o=APIPATH+"/sitedocuments",r=epilogue.resource({model:sql.models.document,endpoints:[o,o+"/:name"]}),d=APIPATH+"/todos",n=epilogue.resource({model:sql.models.todo,endpoints:[d,d+"/:name"]})},module.exports={setup:setup};